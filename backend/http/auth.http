### Variables
@baseUrl = http://localhost:3001/api
# Para Bearer token ( viejo sistema, ya no se usa para CSRF)
# @token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

### ========================================
### AUTH ENDPOINTS
### ========================================

### Health Check
GET {{baseUrl}}/health

### Test DB Connection
GET {{baseUrl}}/test-db

### ----------------------------------------
### LOGIN - Iniciar sesión
# @name login
# Los tokens van en COOKIES (Set-Cookie headers), no en el body
# Ver los Response Headers para ver:
# - Set-Cookie: accessToken=... (HttpOnly)
# - Set-Cookie: refreshToken=... (HttpOnly)
# - Set-Cookie: csrfToken=... (SIN HttpOnly, JS puede leerlo)
# El body solo devuelve csrfToken para referencia
### ----------------------------------------
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@admin.com",
  "password": "123456"
}

### ----------------------------------------
### ME - Obtener usuario autenticado
# Nota: Ahora usa cookies automáticamente, no necesita Authorization header
# @name me
### ----------------------------------------
GET {{baseUrl}}/auth/me
Cookie: accessToken=TOKEN; refreshToken=TOKEN; csrfToken=TOKEN

### ----------------------------------------
### LOGOUT - Cerrar sesión
# Requiere CSRF token header
### ----------------------------------------
POST {{baseUrl}}/auth/logout
Cookie: accessToken=TOKEN; refreshToken=TOKEN; csrfToken=TOKEN
X-CSRF-Token: TOKEN

### ========================================
### TEST CASES
### ========================================

### Login con credenciales inválidas
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "noexiste@test.com",
  "password": "wrongpassword"
}

### Register con email duplicado (debe fallar si ya existe)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test@test.com",
  "password": "123456",
  "name": "Otro User"
}

### ME sin cookies (debe fallar - no hay sesión)
GET {{baseUrl}}/auth/me

### ----------------------------------------
### CÓMO OBTENER LOS TOKENS
### ----------------------------------------
# 1. Hacer POST {{baseUrl}}/login
# 2. Ver los Response Headers (no el body)
# 3. Buscar Set-Cookie:
#    Set-Cookie: accessToken=eyJ...; HttpOnly; SameSite=Lax
#    Set-Cookie: refreshToken=eyJ...; HttpOnly; SameSite=Lax
#    Set-Cookie: csrfToken=0670...; SameSite=Lax
# 4. Copiar los valores en las requests que usen Cookie:
#    Cookie: accessToken=VALOR; refreshToken=VALOR; csrfToken=VALOR
# 5. Para mutaciones (POST/PUT/DELETE), añadir:
#    X-CSRF-Token: VALOR
### ----------------------------------------
